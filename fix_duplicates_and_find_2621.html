<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ 2621</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .info { color: #17a2b8; }
        .warning { color: #ffc107; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        .results { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0; border-left: 4px solid #007bff; }
        .product-item { background: #e9ecef; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .duplicate { background: #f8d7da; border-left: 3px solid #dc3545; }
        .missing { background: #fff3cd; border-left: 3px solid #ffc107; }
    </style>
</head>
<body>
    <h1>üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ 2621</h1>
    
    <div class="section">
        <h2>1. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</h2>
        <button onclick="loadAllProducts()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
        <div id="load-results" class="results"></div>
    </div>
    
    <div class="section">
        <h2>2. –ê–Ω–∞–ª–∏–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤</h2>
        <button onclick="analyzeDuplicates()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã</button>
        <div id="duplicate-analysis" class="results"></div>
    </div>
    
    <div class="section">
        <h2>3. –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ 2621</h2>
        <button onclick="searchFor2621()">–ò—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä 2621</button>
        <div id="search2621-results" class="results"></div>
    </div>
    
    <div class="section">
        <h2>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤</h2>
        <button onclick="findSimilarProducts()">–ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</button>
        <div id="similar-results" class="results"></div>
    </div>

    <script>
        let allProducts = [];
        let duplicateGroups = {};

        async function loadAllProducts() {
            const results = document.getElementById('load-results');
            results.innerHTML = '<div class="info">üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã...</div>';
            
            try {
                const response = await fetch('http://localhost:8000/api/products?start=0&limit=1000');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                allProducts = data.products || [];
                
                results.innerHTML = `
                    <div class="success">‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${allProducts.length} —Ç–æ–≤–∞—Ä–æ–≤</div>
                `;
                
            } catch (error) {
                results.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        function analyzeDuplicates() {
            const results = document.getElementById('duplicate-analysis');
            
            if (allProducts.length === 0) {
                results.innerHTML = '<div class="error">‚ùå –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã</div>';
                return;
            }
            
            results.innerHTML = '<div class="info">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã...</div>';
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é
            const groups = {};
            
            allProducts.forEach(product => {
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ (—É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã, –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É)
                const normalizedName = product.name.toLowerCase().trim().replace(/\s+/g, ' ');
                
                if (!groups[normalizedName]) {
                    groups[normalizedName] = [];
                }
                groups[normalizedName].push(product);
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –≥—Ä—É–ø–ø—ã —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
            duplicateGroups = {};
            Object.keys(groups).forEach(normalizedName => {
                if (groups[normalizedName].length > 1) {
                    duplicateGroups[normalizedName] = groups[normalizedName];
                }
            });
            
            if (Object.keys(duplicateGroups).length > 0) {
                results.innerHTML = `
                    <div class="warning">‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ ${Object.keys(duplicateGroups).length} –≥—Ä—É–ø–ø –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:</div>
                `;
                
                Object.keys(duplicateGroups).forEach((normalizedName, index) => {
                    const products = duplicateGroups[normalizedName];
                    results.innerHTML += `
                        <div class="product-item duplicate">
                            <h4>–ì—Ä—É–ø–ø–∞ ${index + 1}: "${normalizedName}" (${products.length} –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)</h4>
                        </div>
                    `;
                    
                    products.forEach((product, productIndex) => {
                        results.innerHTML += `
                            <div class="product-item" style="margin-left: 20px;">
                                <strong>${productIndex + 1}. ${product.name}</strong><br>
                                <small>ID: ${product.id || 'N/A'}</small><br>
                                <small>–¶–µ–Ω–∞: ${product.price || 'N/A'}</small>
                            </div>
                        `;
                    });
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
                results.innerHTML += `
                    <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 4px;">
                        <h4>üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:</h4>
                        <ul>
                            <li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</li>
                            <li>–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã</li>
                            <li>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ</li>
                            <li>–û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤</li>
                        </ul>
                    </div>
                `;
                
            } else {
                results.innerHTML = '<div class="success">‚úÖ –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
            }
        }

        function searchFor2621() {
            const results = document.getElementById('search2621-results');
            
            if (allProducts.length === 0) {
                results.innerHTML = '<div class="error">‚ùå –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã</div>';
                return;
            }
            
            results.innerHTML = '<div class="info">üîç –ò—â–µ–º —Ç–æ–≤–∞—Ä 2621...</div>';
            
            // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
            const exactMatch = allProducts.filter(product => 
                product.name.includes('2621')
            );
            
            if (exactMatch.length > 0) {
                results.innerHTML = `
                    <div class="success">‚úÖ –ù–∞–π–¥–µ–Ω–æ ${exactMatch.length} —Ç–æ–≤–∞—Ä–æ–≤ —Å 2621:</div>
                `;
                
                exactMatch.forEach((product, index) => {
                    results.innerHTML += `
                        <div class="product-item">
                            <strong>${index + 1}. ${product.name}</strong><br>
                            <small>ID: ${product.id || 'N/A'}</small>
                        </div>
                    `;
                });
            } else {
                results.innerHTML = `
                    <div class="error">‚ùå –¢–æ–≤–∞—Ä 2621 –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ API</div>
                    <div class="warning">‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è:</div>
                    <ul>
                        <li>–¢–æ–≤–∞—Ä –±—ã–ª —É–¥–∞–ª–µ–Ω –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–∞–π—Ç–∞</li>
                        <li>–¢–æ–≤–∞—Ä –±—ã–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω</li>
                        <li>–û—à–∏–±–∫–∞ –≤ —Å–∫—Ä–∏–ø—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥–∞</li>
                        <li>–¢–æ–≤–∞—Ä –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</li>
                    </ul>
                `;
            }
        }

        function findSimilarProducts() {
            const results = document.getElementById('similar-results');
            
            if (allProducts.length === 0) {
                results.innerHTML = '<div class="error">‚ùå –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã</div>';
                return;
            }
            
            results.innerHTML = '<div class="info">üîç –ò—â–µ–º –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã...</div>';
            
            // –ò—â–µ–º —Ç–æ–≤–∞—Ä—ã Ernie Ball —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
            const similarProducts = allProducts.filter(product => {
                const name = product.name.toLowerCase();
                return name.includes('ernie ball') && 
                       (name.includes('regular slinky') || 
                        name.includes('10-56') || 
                        name.includes('paradigm') ||
                        name.includes('7-string') ||
                        name.includes('7 string'));
            });
            
            if (similarProducts.length > 0) {
                results.innerHTML = `
                    <div class="success">‚úÖ –ù–∞–π–¥–µ–Ω–æ ${similarProducts.length} –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ Ernie Ball:</div>
                `;
                
                similarProducts.forEach((product, index) => {
                    const is7String = product.name.toLowerCase().includes('7-string') || 
                                    product.name.toLowerCase().includes('7 string') ||
                                    product.name.toLowerCase().includes('7-—Å—Ç—Ä—É–Ω') ||
                                    product.name.toLowerCase().includes('7 —Å—Ç—Ä—É–Ω');
                    
                    results.innerHTML += `
                        <div class="product-item ${is7String ? 'missing' : ''}">
                            <strong>${index + 1}. ${product.name}</strong><br>
                            <small>7-—Å—Ç—Ä—É–Ω–Ω—ã–π: ${is7String ? '‚úÖ –î–ê' : '‚ùå –ù–ï–¢'}</small>
                        </div>
                    `;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–æ–≤–∞—Ä 2621 —Å—Ä–µ–¥–∏ –ø–æ—Ö–æ–∂–∏—Ö
                const possible2621 = similarProducts.filter(product => 
                    product.name.toLowerCase().includes('regular slinky') && 
                    product.name.toLowerCase().includes('10-56')
                );
                
                if (possible2621.length > 0) {
                    results.innerHTML += `
                        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 4px;">
                            <h4>üéØ –í–æ–∑–º–æ–∂–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ —Ç–æ–≤–∞—Ä 2621:</h4>
                        </div>
                    `;
                    
                    possible2621.forEach((product, index) => {
                        results.innerHTML += `
                            <div class="product-item missing">
                                <strong>${index + 1}. ${product.name}</strong><br>
                                <small>–í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ —Ç–æ–≤–∞—Ä 2621 —Å –¥—Ä—É–≥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º</small>
                            </div>
                        `;
                    });
                }
            } else {
                results.innerHTML = '<div class="error">‚ùå –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
            }
        }
    </script>
</body>
</html>
