<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π 7-string</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .results {
            margin-top: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
        }
        .product-item {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        .duplicate {
            background: #ffe6e6;
            border-left: 3px solid #dc3545;
        }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π 7-string (–≤–µ—Ä—Å–∏—è 13.04)</h1>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ "7-string"</h3>
        <button class="test-button" onclick="testSearchDuplication()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ "7-string"</button>
        <div id="searchResults" class="results"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ –±–∞–Ω–Ω–µ—Ä–∞ "7 —Å—Ç—Ä—É–Ω –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–≥–∏—Ç–∞—Ä—ã"</h3>
        <button class="test-button" onclick="testBannerButton()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–Ω–æ–ø–∫—É –±–∞–Ω–Ω–µ—Ä–∞</button>
        <div id="bannerResults" class="results"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π</h3>
        <button class="test-button" onclick="testEventHandlers()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏</button>
        <div id="handlerResults" class="results"></div>
    </div>

    <script>
        // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
        async function testSearchDuplication() {
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<div class="info">üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∏—Å–∫ "7-string"...</div>';
            
            try {
                const response = await fetch('http://localhost:8000/api/products?search=7-string&start=0&limit=1000');
                const data = await response.json();
                const products = data.products;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                const productNames = products.map(p => p.name);
                const uniqueNames = [...new Set(productNames)];
                const duplicates = productNames.filter((name, index) => productNames.indexOf(name) !== index);
                
                let results = '<div class="info">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:</div>';
                results += `<div>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: ${products.length}</div>`;
                results += `<div>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω: ${uniqueNames.length}</div>`;
                
                if (duplicates.length > 0) {
                    results += '<div class="error">‚ùå –ù–ê–ô–î–ï–ù–´ –î–£–ë–õ–ò–ö–ê–¢–´:</div>';
                    const duplicateCounts = {};
                    duplicates.forEach(name => {
                        duplicateCounts[name] = (duplicateCounts[name] || 0) + 1;
                    });
                    Object.entries(duplicateCounts).forEach(([name, count]) => {
                        results += `<div class="duplicate">"${name}" - ${count + 1} —Ä–∞–∑</div>`;
                    });
                } else {
                    results += '<div class="success">‚úÖ –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
                results += '<div style="margin-top: 15px;"><strong>–í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:</strong></div>';
                products.forEach((product, index) => {
                    const isDuplicate = duplicates.includes(product.name);
                    results += `<div class="product-item ${isDuplicate ? 'duplicate' : ''}">${index + 1}. ${product.name}</div>`;
                });
                
                resultsDiv.innerHTML = results;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }
        
        // –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ –±–∞–Ω–Ω–µ—Ä–∞
        async function testBannerButton() {
            const resultsDiv = document.getElementById('bannerResults');
            resultsDiv.innerHTML = '<div class="info">üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –∫–Ω–æ–ø–∫–∏ –±–∞–Ω–Ω–µ—Ä–∞...</div>';
            
            try {
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –±–∞–Ω–Ω–µ—Ä–∞
                const response = await fetch('http://localhost:8000/api/products?start=0&limit=1000');
                const data = await response.json();
                const allProducts = data.products;
                
                // –§–∏–ª—å—Ç—Ä—É–µ–º 7-—Å—Ç—Ä—É–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–Ω–æ–ø–∫–∞ –±–∞–Ω–Ω–µ—Ä–∞)
                const sevenStringProducts = allProducts.filter(product => 
                    product.name.toLowerCase().includes('7-string') || 
                    product.name.toLowerCase().includes('7 —Å—Ç—Ä—É–Ω') ||
                    product.name.toLowerCase().includes('7-—Å—Ç—Ä—É–Ω') ||
                    product.name.toLowerCase().includes('7 string')
                );
                
                let results = '<div class="info">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ –±–∞–Ω–Ω–µ—Ä–∞:</div>';
                results += `<div class="success">‚úÖ –ù–∞–π–¥–µ–Ω–æ ${sevenStringProducts.length} 7-—Å—Ç—Ä—É–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                const productNames = sevenStringProducts.map(p => p.name);
                const uniqueNames = [...new Set(productNames)];
                const duplicates = productNames.filter((name, index) => productNames.indexOf(name) !== index);
                
                if (duplicates.length > 0) {
                    results += '<div class="error">‚ùå –ù–ê–ô–î–ï–ù–´ –î–£–ë–õ–ò–ö–ê–¢–´:</div>';
                    const duplicateCounts = {};
                    duplicates.forEach(name => {
                        duplicateCounts[name] = (duplicateCounts[name] || 0) + 1;
                    });
                    Object.entries(duplicateCounts).forEach(([name, count]) => {
                        results += `<div class="duplicate">"${name}" - ${count + 1} —Ä–∞–∑</div>`;
                    });
                } else {
                    results += '<div class="success">‚úÖ –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
                results += '<div style="margin-top: 15px;"><strong>–¢–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É:</strong></div>';
                sevenStringProducts.forEach((product, index) => {
                    const isDuplicate = duplicates.includes(product.name);
                    results += `<div class="product-item ${isDuplicate ? 'duplicate' : ''}">${index + 1}. ${product.name}</div>`;
                });
                
                resultsDiv.innerHTML = results;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }
        
        // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function testEventHandlers() {
            const resultsDiv = document.getElementById('handlerResults');
            resultsDiv.innerHTML = '<div class="info">üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π...</div>';
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const searchInput = document.querySelector('.search-input');
                const categoryItems = document.querySelectorAll('.brand-logo');
                const sevenStringButton = document.querySelector('[data-category="7-string"]');
                
                let results = '<div class="info">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:</div>';
                
                if (searchInput) {
                    results += '<div class="success">‚úÖ –ü–æ–∏—Å–∫–æ–≤–æ–µ –ø–æ–ª–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                    if (searchInput._inputHandler) {
                        results += '<div class="success">‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>';
                    } else {
                        results += '<div class="error">‚ùå –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>';
                    }
                } else {
                    results += '<div class="error">‚ùå –ü–æ–∏—Å–∫–æ–≤–æ–µ –ø–æ–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
                
                results += `<div>–ù–∞–π–¥–µ–Ω–æ –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${categoryItems.length}</div>`;
                
                if (sevenStringButton) {
                    results += '<div class="success">‚úÖ –ö–Ω–æ–ø–∫–∞ "7-string" –Ω–∞–π–¥–µ–Ω–∞</div>';
                    if (sevenStringButton._clickHandler) {
                        results += '<div class="success">‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "7-string" –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>';
                    } else {
                        results += '<div class="error">‚ùå –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "7-string" –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>';
                    }
                } else {
                    results += '<div class="error">‚ùå –ö–Ω–æ–ø–∫–∞ "7-string" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>';
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                let handlersCount = 0;
                categoryItems.forEach(item => {
                    if (item._clickHandler) handlersCount++;
                });
                
                results += `<div>–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è ${handlersCount} –∏–∑ ${categoryItems.length} –∫–Ω–æ–ø–æ–∫</div>`;
                
                if (handlersCount === categoryItems.length) {
                    results += '<div class="success">‚úÖ –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã</div>';
                } else {
                    results += '<div class="error">‚ùå –ù–µ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã</div>';
                }
                
                resultsDiv.innerHTML = results;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
